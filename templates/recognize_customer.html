<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, shrink-to-fit=no">
        <title>Customer Tracking</title>
        <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='assets/img/favicon.ico') }}"/>
        <link href="{{ url_for('static', filename='assets/css/loader.css') }}" rel="stylesheet" type="text/css" />
        <script src="{{ url_for('static', filename='assets/js/loader.js') }}"></script>
        <!-- BEGIN GLOBAL MANDATORY STYLES -->
        <link href="https://fonts.googleapis.com/css?family=Nunito:400,600,700" rel="stylesheet">
        <link href="{{ url_for('static', filename='bootstrap/css/bootstrap.min.css') }}" rel="stylesheet" type="text/css" />
        <link href="{{ url_for('static', filename='assets/css/plugins.css') }}" rel="stylesheet" type="text/css" />
        <!-- END GLOBAL MANDATORY STYLES -->
        <!-- BEGIN PAGE LEVEL PLUGINS/CUSTOM STYLES -->
        <style>
            .layout-px-spacing {
                min-height: calc(100vh - 166px)!important;
            }
        </style>
        <!-- END PAGE LEVEL PLUGINS/CUSTOM STYLES -->
    </head>
    <body>
        <!-- BEGIN LOADER -->
        <div id="load_screen"> <div class="loader"> <div class="loader-content">
            <div class="spinner-grow align-self-center"></div>
        </div></div></div>
        <!--  END LOADER -->

        <!--  BEGIN NAVBAR  -->
        <div class="header-container fixed-top">
            <header class="header navbar navbar-expand-sm">

                <ul class="navbar-item theme-brand flex-row  text-center">
                    <li class="nav-item theme-logo">
                        <a href="/">
                            <img src="{{ url_for('static', filename='assets/img/90x90.jpg') }}" class="navbar-logo" alt="logo">
                        </a>
                    </li>
                    <li class="nav-item theme-text">
                        <a href="/" class="nav-link"> Face Recognition Customer Tracking App </a>
                    </li>
                </ul>

                <ul class="navbar-item flex-row ml-md-auto">

                    <li class="nav-item dropdown user-profile-dropdown">
                        <a href="javascript:void(0);" class="nav-link dropdown-toggle user" id="userProfileDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                            <img src="{{ url_for('static', filename='assets/img/90x90.jpg') }}" alt="avatar">
                        </a>
                        <div class="dropdown-menu position-absolute" aria-labelledby="userProfileDropdown">
                            <div class="">
                                <div class="dropdown-item">
                                    <a class="" href="/logout"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-log-out"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg> Sign Out</a>
                                </div>
                            </div>
                        </div>
                    </li>
                </ul>
            </header>
        </div>
        <!--  END NAVBAR  -->

        <!--  BEGIN NAVBAR  -->
        <div class="sub-header-container">
            <header class="header navbar navbar-expand-sm">
                <a href="javascript:void(0);" class="sidebarCollapse" data-placement="bottom"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></a>

                <ul class="navbar-nav flex-row">
                    <li>
                        <div class="page-header">
                            <div class="page-title">
                                <h3>Customer Recognition</h3>
                            </div>
                        </div>
                    </li>
                </ul>
            </header>
        </div>
        <!--  END NAVBAR  -->

        <!--  BEGIN MAIN CONTAINER  -->
        <div class="main-container" id="container">

            <div class="overlay"></div>
            <div class="search-overlay"></div>

            <!--  BEGIN SIDEBAR  -->
            <div class="sidebar-wrapper sidebar-theme">
                
                <nav id="sidebar">
                    <div class="shadow-bottom"></div>

                    <ul class="list-unstyled menu-categories" id="accordionExample">
                        
                        <li class="menu">
                            <a href="/add-customer" data-active="false" aria-expanded="false" class="dropdown-toggle">
                                <div class="">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-user-plus"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="8.5" cy="7" r="4"></circle><line x1="20" y1="8" x2="20" y2="14"></line><line x1="23" y1="11" x2="17" y2="11"></line></svg>
                                    <span>Add Customer</span>
                                </div>
                            </a>
                        </li>

                        <li class="menu">
                            <a href="/" data-active="true" aria-expanded="true" class="dropdown-toggle">
                                <div class="">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-user-check"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="8.5" cy="7" r="4"></circle><polyline points="17 11 19 13 23 9"></polyline></svg>
                                    <span>Recognize Customer</span>
                                </div>
                            </a>
                        </li>

                        <li class="menu">
                            <a href="/manage-customers" data-active="false" aria-expanded="false" class="dropdown-toggle">
                                <div class="">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-users"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
                                    <span >Manage Customers</span>
                                </div>
                            </a>
                        </li>

                        <li class="menu">
                            <a href="/tracking-activities" data-active="false" aria-expanded="false" class="dropdown-toggle">
                                <div class="">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-activity"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline></svg>
                                    <span>Tracking Activities</span>
                                </div>
                            </a>
                        </li>
                    </ul>
                    
                </nav>

            </div>
            <!--  END SIDEBAR  -->
            
            <!--  BEGIN CONTENT PART  -->
            <div id="content" class="main-content">
                <div class="layout-px-spacing">

                    <div class="row layout-top-spacing">

                        <div class="col-lg-12 layout-spacing">
                            <div class="statbox widget box box-shadow">
                                <div class="widget-header">
                                    <div class="row">
                                        <div class="col-xl-12 col-md-12 col-sm-12 col-12">
                                            <h4>Recognize Customer</h4>
                                        </div>                 
                                    </div>
                                </div>

                                {% with messages = get_flashed_messages(with_categories=true) %}
                                {% if messages %}
                                {% for category, message in messages %}
                                    <div class="alert alert-{{category}} alert-dismissible fade show" role="alert">
                                        {{message}}
                                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                {% endfor %}
                                {% endif %}
                                {% endwith %}

                                <div class="widget-content widget-content-area">

                                    <div class="row">
                                        
                                        <div class="col-lg-6 col-6 mx-auto">
                                            <form>
                                                <label>Camera Live Streaming</label>
                                                <div class="card component-card_1" style="height: 350px;">
                                                    <img id="bg" src="{{ url_for('live_streaming') }}">
                                                </div>
                                            </form>
                                        </div>

                                        <div class="col-lg-6 col-6 mx-auto">
                                            <form name="addCustomerVisitEntryForm" id="addCustomerVisitEntryForm" action="" method="POST">
                                                <input type="hidden" name="cust_id" id="cust_id">
                                                <div class="form-row mb-4">
                                                    <div class="form-group col-md-6">
                                                        <label for="fisrt_name">First name</label>
                                                        <input type="text" class="form-control" id="fisrt_name" placeholder="Customer's first name" name="first_name" readonly>
                                                    </div>
                                                    <div class="form-group col-md-6">
                                                        <label for="last_name">Last name</label>
                                                        <input type="text" class="form-control" id="last_name" placeholder="Customer's last name" name="last_name" readonly>
                                                    </div>
                                                </div>
                                                <div class="form-row mb-4">
                                                    <div class="form-group col-md-6">
                                                        <label for="inputAddress">Address</label>
                                                        <input type="text" class="form-control" id="inputAddress" placeholder="1234 Main Street, Abc Twon" name="address" readonly>
                                                    </div>
                                                    <div class="form-group col-md-6">
                                                        <label for="mobile">Mobile no</label>
                                                        <input type="text" class="form-control" id="phone_no" name="phone_no" placeholder="0300-xxxx" readonly>
                                                    </div>
                                                </div>
                                                <label for="current_temperature">Customer current Temperature</label>
                                                <div class="input-group mb-4">
                                                    <div class="input-group-prepend">
                                                        <span class="input-group-text" id="temp_icon">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-thermometer"><path d="M14 14.76V3.5a2.5 2.5 0 0 0-5 0v11.26a4.5 4.5 0 1 0 5 0z"></path></svg>
                                                        </span>
                                                    </div>
                                                    <input type="text" class="form-control" placeholder="Temperature" name="temperature" aria-describedby="temp_icon" required>
                                                </div>
                                                <button type="submit" class="btn btn-primary mt-3">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-check-circle"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
                                                    Add Visiting 
                                                </button>
                                            </form>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>

                    </div>

                </div>
                <div class="footer-wrapper">
                    <div class="footer-section f-section-2">
                        <p class="">Coded with <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-heart"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg> by Roshani Ghimire</p>
                    </div>
                </div>
            </div>
            <!--  END CONTENT PART  -->

        </div>
        <!-- END MAIN CONTAINER -->

        <!-- BEGIN GLOBAL MANDATORY SCRIPTS -->
        <script src="{{ url_for('static', filename='assets/js/libs/jquery-3.1.1.min.js') }}"></script>
        <script src="{{ url_for('static', filename='bootstrap/js/popper.min.js') }}"></script>
        <script src="{{ url_for('static', filename='bootstrap/js/bootstrap.min.js') }}"></script>
        <script src="{{ url_for('static', filename='plugins/perfect-scrollbar/perfect-scrollbar.min.js') }}"></script>
        <script src="{{ url_for('static', filename='assets/js/app.js') }}"></script>
        <script>
            
            $(document).ready(function() {
                App.init();fetchData();
            });

            function fetchData(){
                fetch('/get_file')
                .then(response => {
                    if(response.status == 200){
                        response.text()
                        .then(text => {
                            const data  = text.split(',');
                            $("#cust_id").val(data[0]);
                            $("#fisrt_name").val(data[1]);
                            $("#last_name").val(data[2]);
                            $("#inputAddress").val(data[3]);
                            $("#phone_no").val(data[4]);
                        });
                    }
                    else if(response.status == 404){
                        $("#cust_id").val('');
                        $("#fisrt_name").val('');
                        $("#last_name").val('');
                        $("#inputAddress").val('');
                        $("#phone_no").val('');
                        setTimeout(()=>fetchData(),5000);
                    }
                    // else {
                    //     alert('Server Error');
                    // }
                })
                .catch(error => {
                    
                });
            }
        </script>
        <script src="{{ url_for('static', filename='assets/js/custom.js') }}"></script>
        <!-- END GLOBAL MANDATORY SCRIPTS -->

        <!-- BEGIN PAGE LEVEL PLUGINS/CUSTOM SCRIPTS -->
        <!-- BEGIN PAGE LEVEL PLUGINS/CUSTOM SCRIPTS -->
    </body>
</html>